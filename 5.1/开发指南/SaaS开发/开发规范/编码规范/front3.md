# 第三章 性能优化

## 1. 基本原则

1. 【必须】页面必须在 **2 秒** 之内打开。即，空白页的持续时间不能超过 2 秒

2. 页面需要在 **5 秒** 之内全部加载完成

## 2. 编码建议

1. CSS放 置顶部，JS 放置底部

2. 尽可能的使用 CSS sprites 技术，多图合并，一次请求

3. 多个 JS 文件或多个 CSS 文件 进行合并和压缩

4. 尽可能的使用外部 JS 和 CSS，减少内联或嵌入式 JS 和 CSS

5. 减少重复 JS 和 CSS

6. 避免重定向，尤其是缺少末尾 `/` 的自动重定向

## 3. 异步加载优化

1. 加载顺序

    浏览器在同一时间针对同一域名下的请求有一定数量限制（主流浏览器限制为 6），超过限制数目的请求会被阻塞。因此需要合理安排异步请求加载顺序。

    - 按业务逻辑顺序：先加载主要模块，后加载次要模块
    - 按使用频率顺序：优先加载用户使用频率比较高的模块
    - 按页面可见顺序：先加载用户可见的部分，后加载用户不可见的部分

2. 懒加载

    懒加载就是在加载页面时，只加载可视区域内的数据，当用户滚动页面，可视区域发生改变时才开始对应数据的加载。使用懒加载，可以避免前端大量的并发请求，避免页面卡顿，同时减轻服务器的压力。

    对于需要加载较多图片或图表的页面，建议使用懒加载的方式。
